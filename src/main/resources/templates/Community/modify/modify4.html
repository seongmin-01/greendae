<!DOCTYPE html>
<!--
이름 : 김소현
내용 : 커뮤니티 수정
-->
<html>
<head>
    <meta charset="UTF-8">
    <title>커뮤니티/글수정</title>
    <link rel="stylesheet" href="/css/_header.css">
    <link rel="stylesheet" href="/css/_footer.css">
    <link rel="stylesheet" href="/css/Community/view.css">
    <link rel="stylesheet" href="/css/homebar.css">
    <link rel="stylesheet" href="/css/Community/resource.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <script>
        function togglePassword(isLocked) {
            const passwordRow = document.getElementById("passwordRow");
            passwordRow.style.display = isLocked ? "table-row" : "none";
        }

        function validateForm() {
            const locked = document.querySelector('input[name="locked"]:checked').value;
            const passwordInput = document.querySelector('input[name="password"]');

            if (locked === "true") {
                if (!passwordInput || passwordInput.value.length !== 4 || !/^\d{4}$/.test(passwordInput.value)) {
                    alert("비밀번호는 숫자 4자리로 입력해주세요.");
                    passwordInput.focus();
                    return false;
                }
            }
            return true;
        }
    </script>
</head>
<body>
<div id="wrapper">
    <th:block th:include="/common/__header"/>
    <div class="homebar">
        <article class="inline">
            <a href="/main"><img src="/images/ico-home.png" alt="homeico"></a>
            <img src="/images/bg-path-arrow.png" alt="arrowright">
            <a href="/Community/resource">커뮤니티</a>
            <img src="/images/bg-path-arrow.png" alt="arrowright">
            <a href="/Community/resource">글수정</a>
        </article>
    </div>
    <main id="article">
        <section class="view">
            <article class="notice"  style="padding-left: 0; margin-left: 0">
                <div class="noticetop" style="width: 1200px;">
                    <h4 style="padding-left: 10px;">글수정</h4>
                </div>
            </article>
            <form th:action="@{/Community/modify2}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="writer" th:value="${#authentication.principal.user.id}">
                <input type="hidden" name="cate" th:value="${community2DTO.cate}">
                <input type="hidden" name="no" th:value="${community2DTO.no}">
                <table border="0">
                    <tr>
                        <th>제목</th>
                        <td><input type="text" name="title" th:value="${community2DTO.title}"/></td>
                    </tr>
                    <tr>
                        <th>잠금</th>
                        <td>
                            <input type="radio" name="locked" value="true" onchange="togglePassword(true)"> 예
                            <input type="radio" name="locked" value="false" onchange="togglePassword(false)"> 아니오
                        </td>
                    </tr>

                    <tr id="passwordRow" style="display: none;">
                        <th>비밀번호</th>
                        <td>
                            <input type="password" name="password" maxlength="4" placeholder="숫자 4자리" pattern="\d{4}">
                            <small style="color:gray;">※ 글을 열람할 때 필요한 비밀번호입니다.</small>
                        </td>
                    </tr>
                    <tr>
                        <th>파일</th>
                        <td>
                            <input type="file" name="file1"/><br>
                            <input type="file" name="file2"/><br>
                            <p>
                                최대 2개 파일 첨부 가능, 각 파일당 최대 10MB까지 가능
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <th>내용</th>
                        <td>
                            <textarea name="content">[[${community2DTO.content}]]</textarea>
                        </td>
                    </tr>
                </table>

                <div>
                    <input type="submit" value="수정완료" class="btn btnList" style="margin: 30px 0; float:right" />
                </div>
            </form>
        </section>
    </main>
    <th:block th:include="/common/__footer"/>
</div>
</body>
</html>